function linkText(a){var b,c,d,e;c=/(\b(https?):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;replacedText=a.replace(c,'<a href="$1" target="_blank" class="colored-link-1" title="$1">$1</a>');d=/(^|[^\/])(www\.[\S]+(\b|$))/gim;replacedText=replacedText.replace(d,'$1<a href="http://$2" target="_blank" class="colored-link-1">$2</a>');return replacedText}function shortenLink(a){$.each($(a),function(){if(!$(this).hasClass("linked")){var a=$(this).text();a=a.replace(/(https?):\/\//,"");a=a.replace(/www\./,"");if(a.length>30){a=a.substring(0,27)+"..."}$(this).text(a)}})}function findLink(a){var b;b=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'\"\\.,<>?\u00AB\u00BB\u201C\u201D\u2018\u2019]))/i;if(a.match(b)){var c=RegExp.$1.length;if(c>30){return c-30}else{return 0}}else{return 0}}(function(a,b,c){var d,e=a.getElementsByTagName(b)[0];if(a.getElementById(c))return;d=a.createElement(b);d.id=c;d.src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=340665976008804";e.parentNode.insertBefore(d,e)})(document,"script","facebook-jssdk");!function(a,b,c){var d,e=a.getElementsByTagName(b)[0];if(!a.getElementById(c)){d=a.createElement(b);d.id=c;d.src="//platform.twitter.com/widgets.js";e.parentNode.insertBefore(d,e)}}(document,"script","twitter-wjs");(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="https://apis.google.com/js/plusone.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();$(document).ready(function(){$("#nav-category").click(function(){if($("#sub-nav").is(":visible")){$("#sub-nav").fadeOut(50)}else{$("#sub-nav").fadeIn(100)}$("#dropdown-sub-nav").fadeOut(50);$("#dropdown-form-login").fadeOut(50);$("#notification-dropdown").fadeOut(50)});$(".dropdown-shortlink").mousedown(function(){var a=$(this);var b=$("#dropdown-sub-nav");var c=$("#dropdown-form-login");if(b.length>0){if(b.is(":visible")){b.fadeOut(50)}else{b.fadeIn(100,function(){$("#email").focus()})}}else if(c.length>0){if(c.is(":visible")){c.fadeOut(50)}else{c.fadeIn(100,function(){$("#email").focus()})}}$("#notification-dropdown").fadeOut(50);$("#sub-nav").fadeOut(50)});$("#notification-number").mousedown(function(){if($("#notification-dropdown").is(":visible")){$("#notification-dropdown").fadeOut(50);$("#notification-dropdown li a").each(function(){$(this).removeClass("highlight")});$("#notification-number").attr("src","/images/icons/notification-none.png");$("#notification-header").html("Notifications (0 new)")}else{$("#notification-dropdown").fadeIn(100);var a=0;$("#notification-dropdown li a").each(function(){if($(this).hasClass("highlight")){a++}});if(a!=0){$.post("/php/notifications.php",{action:"markasread"})}}$("#dropdown-sub-nav").fadeOut(50);$("#dropdown-form-login").fadeOut(50);$("#sub-nav").fadeOut(50)});$("#notification-load a").click(function(a){a.preventDefault();var b=$(".ind-notification:last").attr("data-id");$.post("/php/notifications.php",{lastid:b,action:"load"},function(a){if(a!=""&&a!=0){$(a).insertAfter(".ind-notification:last")}else if(a==0){toastr.warning("No more notifications to load.");$("#notification-load").remove()}else{toastr.error("Could not load.")}})});$("#maincolumn").click(function(){$(".dropdown").fadeOut(50)});$("div").on("mouseover",".comment-holder",function(){$(this).find(".comment-options").show()}).mouseout(function(){$(this).find(".comment-options").hide()});var a=160;$("body").on("click",".comment-options p",function(){var a=$(this);var b=a.parents(".comment-holder");if(a.text()=="Delete"){var c=b.find(".username").attr("data-id");if(confirm("Are you sure you want to delete this comment? **All votes and replies will be deleted also**")){b.find(".gif-loader-replies").show();$.post("/php/commentajax.php",{commentid:c,action:"Delete"},function(c){b.find(".gif-loader-replies").hide();if(c==1){toastr.success("Comment deleted.");a.parents(".comment-holder").remove()}else{toastr.error("Something went wrong. Could not delete.")}})}}else if(a.text()=="Spam"){var c=a.parents(".comment-holder").find(".username").attr("data-id");if(confirm("Are you sure you want to report this comment as spam?")){var d=a.parents(".comment-holder");d.find(".gif-loader-replies").show();a.remove();$.post("/php/commentajax.php",{commentid:c,action:"Spam"},function(a){d.find(".gif-loader-replies").hide();if(a==1){toastr.success("Comment reported as spam. Thank you.")}else{toastr.error("Something went wrong. Could not report.")}})}}else if(a.text()=="Remove"){var c=a.parents(".comment-holder").find(".username").attr("data-id");if(confirm("Are you sure you want to remove this comment from the spam list?")){var d=a.parents(".comment-holder");d.find(".gif-loader-replies").show();$.post("/php/commentajax.php",{commentid:c,action:"Remove"},function(b){d.find(".gif-loader-replies").hide();if(b==1){toastr.success("Removed from spam list.");a.closest(".spam-holder").remove();d.remove()}else{toastr.error("Something went wrong. Could not remove.")}})}}}).on("click",".votes-up a",function(a){a.preventDefault();var b=$(this).attr("data-id");var c=$(this).parent();$(this).remove();var d=parseInt(c.find(".votes-up-number").text());var e='Votes up<img src="/images/icons/thumb-up_1.jpg" alt="Vote up" width="14" height="14"/>(<span class="votes-up-number">'+d+"</span>)";c.html(e);c.parents(".comment-holder").find(".gif-loader-replies").show();$.post("/php/votes.php",{vote_up:b},function(a){c.parents(".comment-holder").find(".gif-loader-replies").hide();if(a==1){d=d+1;c.find(".votes-up-number").html(d)}})}).on("keyup",".quick-reply-input",function(){var c=$(this).val();b=findLink(c);if(b>0&&$("#link-present").is(":visible")==false){$(this).parent().find(".link-present").fadeIn(100)}else if(b==0){$(this).parent().find(".link-present").fadeOut(50)}a=160-c.length+b;if(a<=0){$(this).parent().find(".reply-character-count").html(a).css("color","red")}else{$(this).parent().find(".reply-character-count").html(a).css("color","green")}}).on("focusin",".quick-reply-input",function(){$(this).css("height","50px");$(this).parent().find(".reply-btn-holder").show()}).on("click","p.replies-view",function(){var a=$(this);var b=a.attr("data-id");var c=a.parents(".comment-holder");if(c.find(".replies").is(":visible")==false){if(a.attr("data-replies")==0){c.find(".replies").slideDown("fast");a.find("a").html("Close")}else if(c.find(".ind-reply").length>0){c.find(".replies").slideDown("fast");a.find("a").html("Close")}else{c.find(".gif-loader-replies").show();c.find(".view-all-replies").show();$.post("/php/repliesajax.php",{reply:b,type:"load",amount:"few"},function(b){c.find(".gif-loader-replies").hide();if(b!=""){$(b).insertBefore(c.find(".quick-reply-input"));c.find(".replies").slideDown("fast");a.find("a").html("Close");$(c.find(".reply-text")).each(function(){var a=linkText($(this).html());$(this).addClass("linked").html(a)});shortenLink(".reply-text a")}})}}else if(a.find("a").html()=="Close"){c.find(".replies").slideUp("fast");a.find("a").html(a.attr("data-html"))}}).on("click",".view-all-replies",function(){var a=$(this);var b=a.attr("data-id");a.parents(".comment-holder").find(".gif-loader-replies").show();$.post("/php/repliesajax.php",{reply:b,type:"load",amount:"all"},function(b){a.parents(".comment-holder").find(".gif-loader-replies").hide();if(b!=""){$.each($(".ind-reply"),function(){$(this).remove()});$(b).insertBefore(a.parents(".comment-holder").find(".quick-reply-input"));a.hide();$(a.parents(".comment-holder").find(".reply-text")).each(function(){var a=linkText($(this).html());$(this).addClass("linked").html(a)});shortenLink(".reply-text a")}})}).on("click",".quick-reply-button",function(){var b=$(this);var c=$(this).parents(".reply-padding").find(".quick-reply-input").val();var d=$(this).parents(".comment-holder");var e=d.find(".replies-view").attr("data-id");var f=d.find(".username:first").text();if(c==""){toastr.warning("Reply cannot be empty.")}else if(a<0){toastr.warning("Too many characters to submit.")}else{d.find(".gif-loader-replies").show();b.attr("disabled","disabled");$.post("/php/repliesajax.php",{reply:e,type:"enter",text:c,statususername:f},function(a){d.find(".gif-loader-replies").hide();b.removeAttr("disabled");if(a!=""){$(a).insertBefore(d.find(".quick-reply-input"));var c=d.find(".ind-reply:last .reply-text");var e=linkText(c.html());c.addClass("linked").html(e);shortenLink(".ind-reply:last .reply-text a");d.find(".ind-reply:last").slideDown("fast");d.find(".quick-reply-input").val("");d.find(".reply-character-count").html("160");var f=parseInt(d.find(".replies-view").attr("data-replies"))+1;d.find(".replies-view").attr("data-replies",f);d.find(".replies-view span").html("("+f+")");d.find(".view-all-replies p").html("View All Replies ("+f+")");d.find(".reply-btn-holder").hide();d.find(".quick-reply-input").css("height","25px")}})}});var b=0;var c=0;$("#quick-compose-textarea").keypress(function(a){if(a.keyCode==13){a.preventDefault()}}).keyup(function(){var a=$(this).val();b=findLink(a);if(b>0&&$("#link-present").is(":visible")==false){$("#link-present").fadeIn(100)}else if(b==0){$("#link-present").fadeOut(50)}c=240-a.length+b;if(c<=0){$(this).parent().find("#character-count").html(c).css("color","red")}else{$(this).parent().find("#character-count").html(c).css("color","green")}}).focusin(function(){$(this).css({height:"75px","background-color":"white"});$("#grumble-comment div").show()});$("#quick-description-grumblename").keyup(function(){var a=$(this).val();var b=40-a.length;if(b<=0){$(this).parent().find("#character-count").html(b).css("color","red")}else{$(this).parent().find("#character-count").html(b).css("color","green")}}).focusin(function(){var a=$(this).val();var b=40-a.length;if(b<=0){$(this).parent().find("#character-count").html(b).css("color","red")}else{$(this).parent().find("#character-count").html(b).css("color","green")}});var d;$("#quick-description-textarea").keypress(function(a){if(a.keyCode==13){a.preventDefault()}}).on("keyup",function(){var a=$(this).val();b=findLink(a);if(b>0&&$("#link-present").is(":visible")==false){$("#link-present").fadeIn(100)}else if(b==0){$("#link-present").fadeOut(50)}d=500-a.length+b;if(d<=0){$(this).parent().find("#character-count").html(d).css("color","red")}else{$(this).parent().find("#character-count").html(d).css("color","green")}}).focusin(function(){var a=$(this).val();d=500-a.length+b;if(d<=0){$(this).parent().find("#character-count").html(d).css("color","red")}else{$(this).parent().find("#character-count").html(d).css("color","green")}});if($("#referrer").length>0){$("#referrer").val(window.location.pathname)}if($("#login-refer").length>0){$("#login-refer").val(".."+window.location.pathname);$(".social-login a").each(function(){var a=$(this).attr("href");a=a+"&redirect=.."+window.location.pathname;$(this).attr("href",a)})}$("#quick-description-submit").click(function(a){if($("#quick-description-grumblename").val().length>40){a.preventDefault();toastr.warning("Too many characters in Grumble to submit.");$("#quick-description-grumblename").focus()}else if(d<0){a.preventDefault();toastr.warning("Too many characters in Grumble Description to submit.");$("#quick-description-textarea").focus()}else if($("#quick-description-grumblename").val().length==0||$("#quick-description-textarea").val().length==0){a.preventDefault();toastr.warning("Grumble name/description cannot be empty.")}else if($("#grumble-dropdown").val()==0){a.preventDefault();toastr.warning("A category must be selected.")}});$("#open-quick-compose").mousedown(function(){$("#lightbox-container").fadeIn(100);$("#comment-status-lightbox").fadeIn(100,function(){$("#quick-compose-textarea").focus()});$("#lightbox-container").click(function(){$("#lightbox-container").fadeOut(50);$("#comment-status-lightbox").fadeOut(50)});$(".close-quick-submit").click(function(){$("#lightbox-container").fadeOut(50);$("#comment-status-lightbox").fadeOut(50)})});$(".submit-login").click(function(a){if($("#email").val()==""||$("#password").val()==""){a.preventDefault()}});var e=true;var f=false;var g=false;var h=false;var i=false;$(".button").mousedown(function(a){if($(this).val()=="View More"&&e){e=false;var b=$(".tabs a.active:first");if($("#cat-header h1").length>0)var c=$("#cat-header h1").attr("data-id");if($(".user-name").length>0)var d=$(".user-name").attr("data-id");var j="";var k=0;if(b.text()=="Top Grumbles"){j="top";k=$("#tab1 .grumble-holder").length}else if(b.text()=="Recent Grumbles"){j="recent";k=$("#tab2 .grumble-holder:last").find(".grumble-text-holder a").attr("data-id")}else if(b.text()=="Top Comments"){j="top-comment";k=$("#tab3 .comment-holder").length}else if(b.text()=="Recent Comments"){j="recent-comment";k=$("#tab4 .comment-holder:last").find(".username").attr("data-id")}else if(b.text()=="Comments"){j="recent-comment";k=$("#tab1 .comment-holder:last").find(".username").attr("data-id")}else if(b.text()=="Grumbles"){j="recent";k=$("#tab2 .grumble-holder:last").find(".comment-text-holder a").attr("data-id")}if(c!=undefined){$("#gif-loader").show();$.post("/php/categorygrab.php",{catID:c,type:j,last:k},function(a){$("#gif-loader").hide();e=true;if(a!="none"&&j=="top"){$(a).insertAfter($("#tab1 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".grumble-description a")}else if(a!="none"&&j=="recent"){$(a).insertAfter($("#tab2 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".grumble-description a")}else if(a=="none"&&j=="top"){g=="true";$(".view-more").slideUp("fast")}else if(a=="none"&&j=="recent"){f=="true";$(".view-more").slideUp("fast")}})}else if(d!=undefined){$("#gif-loader").show();if(j=="recent-comment"){$.post("/php/commentloadajax.php",{userID:d,type:j,last:k},function(a){$("#gif-loader").hide();e=true;if(a!="none"&&j=="recent-comment"){$(a).insertAfter($("#tab1 .comment-holder:last"))}else if(a=="none"&&j=="recent-comment"){h=="true";$(".view-more").slideUp("fast")}})}else if(j=="recent"){$("#gif-loader").show();$.post("/php/categorygrab.php",{userID:d,catID:c,type:j,last:k},function(a){$("#gif-loader").hide();e=true;if(a!="none"&&j=="recent"){$(a).insertAfter($("#tab2 .grumble-holder:last"))}else if(a=="none"&&j=="recent"){f=="true";$(".view-more").slideUp("fast")}})}}else{$("#gif-loader").show();if(j=="top"||j=="recent"){$.post("/php/categorygrab.php",{type:j,last:k},function(a){e=true;$("#gif-loader").hide();if(a!="none"&&j=="top"){$(a).insertAfter($("#tab1 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".grumble-description a")}else if(a!="none"&&j=="recent"){$(a).insertAfter($("#tab2 .grumble-holder:last"));$.each($(".grumble-description"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".grumble-description a")}else if(a=="none"&&j=="top"){g=="true";$(".view-more").slideUp("fast")}else if(a=="none"&&j=="recent"){f=="true";$(".view-more").slideUp("fast")}})}else if(j=="top-comment"||j=="recent-comment"){$.post("/php/commentloadajax.php",{type:j,last:k,location:"home"},function(a){$("#gif-loader").hide();e=true;if(a!="none"&&j=="top-comment"){$(a).insertAfter($("#tab3 .comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".comment-text a")}else if(a!="none"&&j=="recent-comment"){$(a).insertAfter($("#tab4 .comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".comment-text a")}else if(a=="none"&&j=="top-comment"){i=="true";$(".view-more").slideUp("fast")}else if(a=="none"&&j=="recent-comment"){h=="true";$(".view-more").slideUp("fast")}})}}}else if($(this).text()=="Settings"){$("#settings-holder").stop().animate({top:"46px"},"normal");$("#settings-background").stop().fadeIn("normal");$("#settings-background").click(function(){$("#settings-holder").stop().animate({top:"-500px"},"normal");$("#settings-background").stop().fadeOut("normal")})}else if($(this).text()=="Close"){$("#settings-holder").stop().animate({top:"-500px"},"normal");$("#settings-background").stop().fadeOut("normal")}});$("#grumble-comment-form").submit(function(a){var b=$(this);a.preventDefault();if(c<0){toastr.warning("Too many characters to submit.")}else if($("#quick-compose-textarea").val().length==0){toastr.warning("Grumble cannot be empty.")}else{var d=$("#quick-compose-textarea").val();var e=$("#comment-category").val();$(b).find(".button").attr("disabled","disabled");$(b).find("#gif-loader-comment").show();$.post("/php/commentajax.php",{comment:d,category:e},function(a){$(b).find("#gif-loader-comment").hide();$(b).find(".button").removeAttr("disabled");if(a==0||a==""){toastr.error("Something went wrong. Please check your entries.")}else if(a==1){toastr.warning("Already submitted.")}else if(a!=""){if($(".comment-holder").length>0){$(a).insertBefore(".comment-holder:first");var c=linkText($(".comment-text:first").text());$(".comment-text:first").addClass("linked").html(c);shortenLink(".comment-text:first a")}else{$("<div id='comments-left-header'><h4>Comments</h4></div>").insertBefore("#grumble-comment");$(a).insertAfter("#grumble-comment");$("#comments-left .text-align-center").remove();var c=linkText($(".comment-text:first").text());$(".comment-text:first").addClass("linked").html(c);shortenLink(".comment-text:first a")}if($("#comments-left-header").length>0){var d=parseInt($("#comments-left-header span").text())+1;$("#comments-left-header span").html(d)}$("#quick-compose-textarea").val("").css({height:"20px","background-color":"#FFF9E8"});$("#grumble-comment div").hide()}})}});$("button").removeAttr("disabled");$("#start-new-grumble").mousedown(function(){$("#lightbox-container").fadeIn(100);$("#grumble-lightbox").fadeIn(100,function(){$("#quick-description-grumblename").focus()});$("#lightbox-container").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-lightbox").fadeOut(50);$("#help-callout").fadeOut(50)});$(".close-quick-submit").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-lightbox").fadeOut(50);$("#help-callout").fadeOut(50)})});var j=true;var k=1;var l=0;var m=true;var n=$("#comments-filter").val();if($("#comments-left .comment-holder").length==10){$(window).scroll(function(){if($(window).scrollTop()>=$(document).height()-$(window).height()&&e){e=false;l=$("#subcat-id").attr("data-id");if(l==null){l=$.urlParam("id")}if(n=="recent")var a=$(".username:last").attr("data-id");else var a=$(".comment-holder").length;$("#gif-loader").fadeIn(50);$.post("/php/commentloadajax.php",{typescroll:n,pagenumber:k,number:10,subCat:l,lastid:a},function(a){$("#gif-loader").fadeOut(50);if(a=="none"){j=false;e=false;$("#load-more-grumbles").hide();toastr.warning("No more comments to load.")}else if(a!=""){e=true;j=true;k++;$(a).insertAfter($(".comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".comment-text a")}})}});$("#load-more-grumbles").click(function(){if(e){e=false;l=$("#subcat-id").attr("data-id");if(l==null){l=$.urlParam("id")}if(n=="recent")var a=$(".username:last").attr("data-id");else var a=$(".comment-holder").length;$("#gif-loader").fadeIn(50);$.post("/php/commentloadajax.php",{typescroll:n,pagenumber:k,number:10,subCat:l,lastid:a},function(a){$("#gif-loader").fadeOut(50);if(a=="none"){j=false;e=false;$("#load-more-grumbles").hide();toastr.warning("No more comments to load.")}else if(a!=""){e=true;j=true;k++;$(a).insertAfter($(".comment-holder:last"));$.each($(".comment-text"),function(){if(!$(this).hasClass("linked")){var a=linkText($(this).html());$(this).addClass("linked").html(a)}});shortenLink(".comment-text a")}})}});$("#comments-filter").change(function(){var a=$(this).val();l=$("#subcat-id").attr("data-id");if(l==null){l=$.urlParam("id")}if(m&&a!=n){n=a;m=false;j=true;e=true;$(".comment-holder").each(function(){$(this).remove()});$("#gif-loader").show();$.post("/php/commentloadajax.php",{type:a,subCat:l},function(a){m=true;$("#gif-loader").hide();if(a!="none"&&a!=""){if($("#grumble-comment").length>0)$(a).insertAfter("#grumble-comment");else $(a).insertAfter("#comments-left-header")}else{toastr.error("No comments loaded.")}})}})}$("ul.tabs").each(function(){var a,b,c=$(this).find("a");a=c.first().addClass("active");b=$(a.attr("href"));c.not(":first").each(function(){$($(this).attr("href")).hide()});var d=$(".tabs a.active").position();d=d.left+$(".tabs a.active").width()/2-$("#arrow-top img").width()/2;$("#arrow-top img").css("margin-left",d);$(this).on("click","a",function(c){if($("#tab2 .grumble-holder").length>=10&&$(this).html()=="Recent Grumbles"&&!f||$("#tab1 .grumble-holder").length>=10&&$(this).html()=="Top Grumbles"&&!g||$("#tab4 .comment-holder").length>=10&&$(this).html()=="Recent Comments"&&!h||$("#tab3 .comment-holder").length>=10&&$(this).html()=="Top Comments"&&!i||$("#tab2 .grumble-holder").length>=10&&$(this).html()=="Grumbles"&&!g||$("#tab1 .comment-holder").length>=10&&$(this).html()=="Comments"&&!h){$(".view-more").slideDown("fast")}else{$(".view-more").slideUp("fast")}var d=$(this).position();d=d.left+$(this).width()/2-$("#arrow-top img").width()/2;$("#arrow-top img").animate({marginLeft:d},"normal");a.removeClass("active");b.fadeOut("fast");a=$(this);b=$($(this).attr("href"));a.addClass("active");b.fadeIn("normal");c.preventDefault()})});if($("ul.tabs").length>0){$(window).resize(function(){var a=$(".tabs a.active").position();a=a.left+$(".tabs a.active").width()/2-$("#arrow-top img").width()/2;$("#arrow-top img").css("margin-left",a)})}$.urlParam=function(a){var b=null;var b=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(window.location.href);if(b!=null){return b[1]||0}};if($.urlParam("login")==1){var o=$("#dropdown-form");$("#dropdown-form").fadeIn(100);o.parent().find(".login-drop-image").attr("src","images/arrow-down.png");$("#email").focus()}if($.urlParam("create")=="new"){$("#lightbox-container").fadeIn(100);$("#grumble-share").fadeIn(100);$("#lightbox-container").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-share").fadeOut(50)});$(".close-quick-submit").click(function(){$("#lightbox-container").fadeOut(50);$("#grumble-share").fadeOut(50)})}if($.urlParam("login")=="failed"){toastr.error("Incorrect email/password entered.")}$("#forg-submit").click(function(a){if($("#pass-forg").val()==""||$("#pass-forg2").val()==""){a.preventDefault();toastr.warning("Cannot leave a field blank.")}else if($("#pass-forg").val().length<=5){a.preventDefault();toastr.warning("Password has to be longer than 5 characters.")}else if($("#pass-forg").val()!=$("#pass-forg2").val()){a.preventDefault();toastr.warning("Passwords have to match.")}});$(".help-callout").click(function(a){$("#help-callout div").html("");var b=$(this).attr("data-id");var c=$(this).offset();$("#help-callout").css({left:c.left-18,top:c.top+25}).fadeIn(100);$("#help-callout").mouseleave(function(){$("#help-callout").fadeOut(50)});$("label").mouseenter(function(){$("#help-callout").fadeOut(50)});$.post("/php/helploadajax.php",{id:b},function(a){if(a!=""){$("#help-callout div").append(a)}else{$("#help-callout div").append("<p>No help found.</p>")}})});if($(".comment-text").length>0){$.each($(".comment-text"),function(){var a=linkText($(this).html());$(this).addClass("linked").html(a)});shortenLink(".comment-text a")}if($("#sub-category-desc").length>0){var p=linkText($("#sub-category-desc").html());$("#sub-category-desc").html(p);shortenLink("#sub-category-desc a");$("#sub-category-desc").shorten({showChars:190})}if($(".grumble-description").length>0){$.each($(".grumble-description"),function(){var a=linkText($(this).html());$(this).addClass("linked").html(a)});shortenLink(".grumble-description a")}});(function(a,b){a.toastr=function(){var a={tapToDismiss:true,toastClass:"toast",containerId:"toast-container",debug:false,fadeIn:300,fadeOut:700,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-center",timeOut:3e3,titleClass:"toast-title",messageClass:"toast-message"},c=function(a,b){return g({iconClass:e().iconClasses.error,message:a,title:b})},d=function(a){var c=b("#"+a.containerId);if(c.length)return c;c=b("<div/>").attr("id",a.containerId).addClass(a.positionClass);c.appendTo(b("body"));return c},e=function(){return b.extend({},a,toastr.options)},f=function(a,b){return g({iconClass:e().iconClasses.info,message:a,title:b})},g=function(a){var c=e(),f=a.iconClass||c.iconClass,g=null,h=d(c),i=b("<div/>"),j=b("<div/>"),k=b("<div/>"),l={options:c,map:a};if(a.iconClass){i.addClass(c.toastClass).addClass(f)}if(a.title){j.append(a.title).addClass(c.titleClass);i.append(j)}if(a.message){k.append(a.message).addClass(c.messageClass);i.append(k)}var m=function(){if(b(":focus",i).length>0)return;var a=function(){return i.fadeOut(c.fadeOut)};b.when(a()).done(function(){if(i.is(":visible")){return}i.remove();if(h.children().length===0)h.remove()})};var n=function(){if(c.timeOut>0||c.extendedTimeOut>0){g=setTimeout(m,c.extendedTimeOut)}};var o=function(){clearTimeout(g);i.stop(true,true).fadeIn(c.fadeIn)};i.hide();h.prepend(i);i.fadeIn(c.fadeIn);if(c.timeOut>0){g=setTimeout(m,c.timeOut)}i.hover(o,n);if(!c.onclick&&c.tapToDismiss){i.click(m)}if(c.onclick){i.click(function(){c.onclick()&&m()})}if(c.debug){console.log(l)}return i},h=function(a,b){return g({iconClass:e().iconClasses.success,message:a,title:b})},i=function(a,b){return g({iconClass:e().iconClasses.warning,message:a,title:b})};return{error:c,info:f,options:{},success:h,warning:i}}()})(window,jQuery);jQuery.fn.shorten=function(a){var b={showChars:100,ellipsesText:"...",moreText:"more",lessText:"less"};if(a){$.extend(b,a)}$(".morelink").live("click",function(){var a=$(this);if(a.hasClass("less")){a.removeClass("less");a.html(b.moreText)}else{a.addClass("less");a.html(b.lessText)}a.parent().prev().toggle();a.prev().toggle();return false});return this.each(function(){var a=$(this);var c=a.html();if(c.length>b.showChars){var d=c.substr(0,b.showChars);var e=c.substr(b.showChars,c.length-b.showChars);var f=d+'<span class="moreellipses">'+b.ellipsesText+' </span><span class="morecontent"><span>'+e+'</span>  <a href="javascript://nop/" class="morelink colored-link-1">'+b.moreText+"</a></span>";a.html(f);$(".morecontent span").hide()}})}